\documentclass[a4paper, 11pt]{article}

\usepackage{xcolor}
\input{/home/aroquemaurel/cours/templates/templates/couleurs.tex}
\usepackage{lmodern}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc} \usepackage[francais]{babel}
\usepackage[top=1.7cm, bottom=1.7cm, left=2.5cm, right=2.5cm]{geometry}
\usepackage{verbatim}
\usepackage{tikz} %Vectoriel
\usepackage{pgfplots}
\usepackage{listings}
\usepackage{fancyhdr}
\usepackage{multido}
\usepackage{amssymb}
\usepackage{multicol}
\usepackage{float}
\usepackage[urlbordercolor={1 1 1}, linkbordercolor={1 1 1}, linkcolor=vert1, urlcolor=bleu, colorlinks=true]{hyperref}

\newcommand{\titre}{Plaquage de textures en lancer de rayons}
\newcommand{\numero}{3}
\newcommand{\typeDoc}{DM}
\newcommand{\module}{Outils Informatiques pour le Multimédia}
\newcommand{\sigle}{OIM}
\newcommand{\semestre}{7}
\newcommand{\auteur}{Antoine de \bsc{Roquemaurel} (G1.1)}

\input{/home/aroquemaurel/cours/templates/templates/classroomsTemplates/l3/tddm.tex}
\input{/home/aroquemaurel/cours/templates/templates/listings.tex} %prise en charge du langage C 
\input{/home/aroquemaurel/cours/templates/templates/classroomsTemplates/l3/remarquesExempleAttention.tex}
\input{/home/aroquemaurel/cours/templates/templates/polices.tex}
\input{/home/aroquemaurel/cours/templates/templates/affichageChapitre.tex}
\makeatother

\begin{document}
	\maketitle
	\section{Avant-propos}
	L'archive que vous avez obtenu sur Moodle contient plusieurs fichiers organisés comme suit : 
	\begin{description}
		\item[\texttt{src/}] Contient uniquement les fichiers modifiés, c'est-à-dire \texttt{main.cpp}, \texttt{texturefetch.cpp} et \texttt{color.hpp}.
		\item[\texttt{report\_AntoinedeRoquemaurel.pdf}] Le présent rapport que vous êtes en train de lire
	\end{description}

	Comme vous avez pu le voir, j'ai choisi de modifier la classe \texttt{Color}. Ces modifications n'étaient pas indispensables, mais permettait d'améliorer la
	lecture du code. Ainsi j'ai ajouté 3 méthodes : 
	\begin{itemize}
		\item Opérateur \texttt{+=}, permettant d'éviter de faire \texttt{color = color + other}, le \texttt{+=} est plus rapide et facile à lire.
		\item De la même manière, l'opérateur \texttt{*=}.
		\item Méthode \texttt{reset()} qui remet toutes les composantes à \texttt{0.f}.
	\end{itemize}

	\section{Opérateur \texttt{getTextel()}}
	Une fois les textures intégrés, on peut observer un effet << d'escalier >> sur le quadrillage de l'image, principalement au premier plan, comme le montre la
	figure \ref{fig:fig1}. 

	\begin{figure}[H]
		\centering
		\includegraphics[width=12cm]{1-monimage.png}
		\caption{Image obtenue après le développement de \texttt{getTextel()}}
		\label{fig:fig1}
	\end{figure}
	Cela vient du fait que nous essayons d'intégrer une texture 2D sur des figures 3D. Afin de bien représenter une profondeur sur nos textures 2D, nous les
	avons déformés afin que sa taille en premier plan soit plus grande que la taille en arrière plan. C'est cette transformation qui créer un effet de
	\textit{crênelage} sur le devant de la scène.

	\section{Opérateur d'interpolation linéaire pour l'accès à un élément de texture}
	Afin d'améliorer la qualité de notre image, nous avons effectué une interpolation linéaire des pixels voisins. Le but de ce calcul est de prendre en compte
	les voisins pour afficher notre pixel, ainsi cela va créer un effet « d'adoucissement » dans les zones à fort contraste : le quadrillage par exemple.

	C'est ainsi que notre quadrillage va maintenant avoir un effet de << flou >> cachant le crénelage précédent. 
	\begin{figure}[H]
		\centering
		\includegraphics[width=12cm]{2-monimage.png}
		\caption{Image obtenue après le développement de \texttt{interpolateTexture()}}
		\label{fig:fig1}
	\end{figure}
	\section{Opérateur d'intégration pour le filtrage de texture}
	Une fois cette fonction développée, le temps d'exécution à grimpé en flèche comme le montre le listing \ref{lst:time1}.
	\begin{figure}[H]
		\centering
		\includegraphics[width=12cm]{3-monimage.png}
		\caption{Image obtenue après le développement de \texttt{integrateTexture()}}
		\label{fig:fig1}
	\end{figure}

	En effet, cette fonction par sa simple programmation va effectuer énormément de calculs : calculer pour chaque pixels voisins une moyenne de leur couleur,
	ainsi pour chaque groupe de pixels nous allons faire une division, opération très couteuse. Plus l'image est grande et possède un delta important, plus
	l'opération sera longue.

	Cette opération est cependant très bénéfique : elle va permettre de supprimer les problèmes de qualité présents jusqu'à maintenant, principalement le noir
	présent en haut du cône. 

	Cela est réalisé grâce à cette fonction qui l'a colorié en fonction de ces voisins.
	\begin{lstlisting}[language=Sh, label=lst:time1, caption=Temps d'execution avec \texttt{interpolateTexture}]
aroquemaurel@Luffy ~/projets/cpp/raytracing/bin <master> time ./main
./main  13,19s user 0,04s system 98% cpu 13,459 total
\end{lstlisting}
	\section{Opérateur de pré-filtrage de texture}
	% TODO of features… :-p
	% TODO talk about execution time

	Après le développement de cette fonction, le temps d'exécution a été divisé par plus de 4 ! 
\begin{lstlisting}[language=Sh]
aroquemaurel@Luffy ~/projets/cpp/raytracing/bin <master> time ./main
./main  3,09s user 0,03s system 94% cpu 3,300 total
\end{lstlisting}
	\begin{figure}[H]
		\centering
		\includegraphics[width=12cm]{3-monimage.png}
		\caption{Image obtenue après le développement de \texttt{prefilterTexture()}}
		\label{fig:fig1}
	\end{figure}

	\section{Analyse et estimation des limites des techniques de filtrage implantées}
	% TODO Google search !
\end{document}
